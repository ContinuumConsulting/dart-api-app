<!DOCTYPE html>
<html>
  <head>
    <link rel="components" href="doc_link.html">
    <link rel="components" href="details.html">
  </head>

  <body>
  <element name="x-member-blocks" extends="div">
    <template>
      <template iterate='block in blocks'>
        <div>
          <h3 class="member-block-title">{{block.kindTitle}}</h3>
          <template iterate='element in block.elements'>
            <x-element-summary element="{{element}}"></x-element-summary>
          </template>
        </div>
      </template>
    </template>
    <script type="application/dart">
      import 'package:web_ui/web_ui.dart';
      import 'package:api_doc/ast.dart';
      import 'package:api_doc/model.dart';

      class MemberBlocks extends WebComponent {
        List<ElementBlock> blocks;
      }
    </script>
  </element>

  <element name="x-element-signature" extends="span">
    <template>
      <span class="element-class">
        <template instantiate="if hasReturnType">
          <x-doc-link ref="{{element.returnType}}"></x-doc-link>
        </template>
      </span>
      <span class="element-definition">
        <span class="element-name"><x-doc-link ref="{{element}}" short="{{true}}"></x-doc-link></span><template instantiate="if hasArguments"><span class="args">(<template iterate="param in element.parameters"><span class="arg"><template instantiate="if param.type != null"><span class="arg-type"><x-doc-link ref="{{param.type}}"></x-doc-link> </span></template><span class="arg-name">{{param.name}}</span></span></template>)</span></template>
      </span>
    </template>
    <script type="application/dart">
      import 'package:web_ui/web_ui.dart';
      import 'package:api_doc/ast.dart';
      import 'package:api_doc/model.dart';

      class ElementSignature extends WebComponent {
        Element element;

        bool get hasReturnType =>
          (element is MethodLikeElement || element is TypedefElement)
              && element.returnType != null;

        bool get hasArguments =>
          element is MethodElement || element is ConstructorElement
              || element is TypedefElement;
      }
    </script>
  </element>

  <element name="x-element-summary" extends="div">
    <template>
      <!--TODO(jacobr): use id instead of data-id and use a different escaping scheme-->
      <x-details class="element-details {{kindClass}} {{memberOrTypeClass}}"
          data-id="{{element.id}}"
          open="{{isOpen}}">
         <summary>
          <template instantiate="if element is! ClassElement">
            <x-element-signature element="{{element}}">
            </x-element-signature>
          </template>
          <template instantiate="if element is ClassElement">
            <x-doc-link class="element-name element-definition"
                ref="{{element}}">
            </x-doc-link>
          </template>
        </summary>
        <x-summary-only>
          <p class="member-details-summary">{{element.commentHtmlSnippet}}</p>
        </x-summary-only>
        <div class="documentation">{{element.commentHtml}}</div>
      </x-details>
    </template>
    <script type="application/dart">
      import 'package:web_ui/web_ui.dart';
      import 'package:api_doc/ast.dart';
      import 'package:api_doc/model.dart';

      class ElementSummary extends WebComponent {
        Element element;

        String get kindClass => kindCssClass(element);
        String get memberOrTypeClass =>
          (element is MethodLikeElement) ? 'member-details' : 'type-details';

        bool get isOpen =>
            currentMember != null && element.id == currentMember.id;
      }
    </script>
  </element>

  <element name="x-class-hierarchy-subtree" extends="div">
    <template>
      <template instantiate="if (index < clazz.superclasses.length)">
        <div><x-doc-link ref={{clazz.superclasses[index]}}></x-doc-link></div>
        <!-- TODO(jacobr): why doesn't it work to just put this class on the
             x-class-hierarchy-subtree node? -->
        <div class="child-subtree">
          <x-class-hierarchy-subtree clazz="{{clazz}}" index="{{index+1}}">
          </x-class-hierarchy-subtree>
        </div>
      </template>
      <template instantiate="if index == clazz.superclasses.length">
        <div><strong>{{clazz.shortDescription}}</strong></div>
      </template>
    </template>
    <script type="application/dart">
      // TODO(jacobr): this is kinda a rediculous way to do this
      import 'package:web_ui/web_ui.dart';
      import 'package:api_doc/ast.dart';
      import 'package:api_doc/model.dart';

      class ClassHierarchySubtree extends WebComponent {
        ClassElement clazz;
        int index;
      }
    </script>
  </element>

  <element name="x-class-hierarchy" extends="div">
    <template>
      <x-class-hierarchy-subtree clazz="{{clazz}}" index="{{0}}">
      </x-class-hierarchy-subtree>
    </template>
    <script type="application/dart">
      import 'package:web_ui/web_ui.dart';
      import 'package:api_doc/ast.dart';
      import 'package:api_doc/model.dart';

      class ClassHierarchy extends WebComponent {
        ClassElement clazz;
      }
    </script>
  </element>
</body></html>